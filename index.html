<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>مولّد الصفحة الشخصية</title>
<style>
body { font-family: 'Tahoma', sans-serif; background:#f9f9f9; margin:0; padding:20px; }
.container { max-width:900px; margin:auto; background:#fff; padding:20px 30px; border-radius:15px; box-shadow:0 4px 20px rgba(0,0,0,0.1); }
form { display:flex; flex-direction:column; gap:10px; }
input, textarea, button { padding:10px; border-radius:8px; border:1px solid #ccc; font-size:14px; }
button { background:#c8102e; color:#fff; font-weight:bold; border:none; cursor:pointer; }
button:hover { background:#a50b24; }
label { font-weight:bold; margin-top:10px; }
</style>
</head>
<body>

<div class="container">
<h1>مولّد الصفحة الشخصية</h1>

<form id="profileForm">
<input type="text" id="name" placeholder="اسم الرئيس" value="علي محمد عيسى اسحاقي">
<textarea id="bio" placeholder="نبذة تعريفية" rows="3">نبذة تعريفية افتراضية...</textarea>
<textarea id="experience" placeholder="الخبرات (سطر بسطر)" rows="3">16 سنة رئيس الاتحاد البحريني لكرة اليد.</textarea>
<textarea id="achievements" placeholder="الإنجازات (سطر بسطر)" rows="3">تأسيس أكاديمية كرة اليد
تنظيم بطولات محلية ودولية</textarea>
<input type="text" id="email" placeholder="البريد الإلكتروني" value="example@email.com">
<input type="text" id="phone" placeholder="الهاتف" value="0000-0000">

<label>رفع الصورة الشخصية</label>
<input type="file" id="profileImg" accept="image/*">

<label>رفع شعار الاتحاد</label>
<input type="file" id="logoImg" accept="image/*">

<label>رفع ملف CV</label>
<input type="file" id="cvFile" accept=".pdf">

<button type="button" onclick="generatePage()">توليد وتحميل الصفحة النهائية</button>
</form>
</div>

<script>
async function fileToBase64(file){
    return new Promise((resolve,reject)=>{
        if(!file){ resolve(''); return; }
        const reader = new FileReader();
        reader.onload = ()=>resolve(reader.result);
        reader.onerror = ()=>reject("فشل تحميل الملف: "+file.name);
        reader.readAsDataURL(file);
    });
}

let lastHTML = "";

async function generatePage(){
    try{
        const name = document.getElementById('name').value;
        const bio = document.getElementById('bio').value;
        const experience = document.getElementById('experience').value.split('\n').filter(l=>l.trim()!=='');
        const achievements = document.getElementById('achievements').value.split('\n').filter(l=>l.trim()!=='');
        const email = document.getElementById('email').value;
        const phone = document.getElementById('phone').value;

        const profileFile = document.getElementById('profileImg').files[0];
        const logoFile = document.getElementById('logoImg').files[0];
        const cvFile = document.getElementById('cvFile').files[0];

        const profileBase64 = await fileToBase64(profileFile);
        const logoBase64 = await fileToBase64(logoFile);
        const cvBase64 = await fileToBase64(cvFile);

        lastHTML = `
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>${name}</title>
<style>
body { font-family:'Tahoma',sans-serif; background:#f9f9f9; padding:20px; }
header { text-align:center; background:#c8102e; color:white; padding:20px; border-radius:15px;}
header img.profile { width:150px; border-radius:50%; border:3px solid white; }
header img.logo { width:80px; margin-top:10px; }
h1,h2,h3 { margin:5px 0; }
ul { list-style-type: disc; padding-left:20px; }
</style>
</head>
<body>
<header>
<img src="${profileBase64}" class="profile">
<h1>${name}</h1>
<h3>رئيس الاتحاد البحريني لكرة اليد</h3>
<img src="${logoBase64}" class="logo">
</header>

<div>
<h2>نبذة تعريفية</h2>
<p>${bio}</p>

<h2>الخبرات</h2>
<ul>${experience.map(e=>`<li>${e}</li>`).join('')}</ul>

<h2>الإنجازات</h2>
<ul>${achievements.map(a=>`<li>${a}</li>`).join('')}</ul>

<h2>معلومات التواصل</h2>
<p>البريد: ${email}<br>الهاتف: ${phone}</p>

<h2>السيرة الذاتية</h2>
<a href="${cvBase64}" download="${name}_CV.pdf">تحميل ملف CV</a>

</div>
</body>
</html>
        `;

        // تحميل HTML النهائي مباشرة
        const blob = new Blob([lastHTML], {type:"text/html"});
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = "profile_page.html";
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);

    } catch(err){ alert(err); }
}
</script>

</body>
</html>
